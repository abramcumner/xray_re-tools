Интересная информация от бардака, по поводу компиляции карт и ЧН.

Вопрос: 

А почему бы не создать чистильщик полигонов invalid faces для декомпилированных карт?

Ответ:

Давайте подумаем. дано: 

1) скомпилированная карта из современной сборки (2215 и старше); 

2) известный факт, что при компиляции xrLC ругается на неправильные треугольники. 

Формальный вывод? правильно, уже скомпилированная карта ошибок не содержит.

Реально ситуация более сложная: 

могут быть полностью вырожденные треугольники (то есть площадь их строго равна 0) 

из-за nvstrip/nvmeshmender, но такие можно безболезненно удалять автоматически, что и делается.

откуда же берутся битые полигоны при повторной компиляции? вот откуда: xrLC пытается оптимизировать 

геометрию и объединяет близко расположенные вершины, в результате из "хорошего" треугольника получается "плохой". 

далее, почему вообще нельзя тупо удалять "плохие" треугольники автоматически, а нужно напрягать этим дизайнера? 

проще всего объяснить на примере escape из 1114/1154. декомпилируйте, загрузите его в LE, импортируйте 

список ошибок из logs\\converter_escape1154.err и представьте, что все подсвеченные полигоны были удалены.

Вопрос: 

Экспортировал геометрию Сталкера выдранную плагином каспера в SDK, тормозит, почему?

Ответ:

Скорость работы и загрузки LE зависит от того, как побита геометрия. можно выписать такие правила:

1) чем больше mesh'ей в .object'ах, тем медленнее работа.

2) чем больше треугольников в отдельной mesh'и и чем сложнее её форма, тем медленнее загрузка карты в LE.

3) количество _отдельных_ .object на скорость работы и загрузки влияет слабо.

Ключ "-mode maya" изначально был сделан для загрузки геометрии в майку. при этом создаётся один .object, 

но куча mesh'ей, что удобно для работы в майе (позднее пригодилось и для макс-плагина). однако перед 

экспортом нужно все эти кучи mesh'ей объединять в логические группы (здания, земля и т.д.) для быстрой работы LE.


Вопрос:

Перенос ТЧ в ЧН, ЧН в ТЧ и тому подобное. Как осуществить?

Ответ:

По поводу переноса ТЧ в ЧН (целиком). вот инструкция для 3120:

1) поправить XR_3DA.exe из 3120 таким образом (чтоб работал с .dbN от русской версии)

; заменяем SEED0_WW на SEED0_RU
0x000e90d4: 0x4b -> 0x36
0x000e90d5: 0xbc -> 0x94
0x000e90d6: 0x5b -> 0x32
0x000e90d7: 0x00 -> 0x01

; заменяем SEED_WW на SEED_RU
0x000e9154: 0xeb -> 0xd3
0x000e9155: 0xb2 -> 0xa9
0x000e9156: 0x6e -> 0x31
0x000e9157: 0x01 -> 0x01

; заменяем SIZE_MULT_WW на SIZE_MULT_RU
0x0000fedc: 0x04 -> 0x08

2) aiwrapper -upgrade 3120. на выходе -- дерево с all.spawn и level.ai.

3) поправить fsgame.ltx (config -> configs и ещё что-то).

4) поправить погоду, что-то в configs\ui -- по вылетам понятно.

5) заменить некоторые .ogf/.omf (вороны, люди -- по вылетам будет понятно).

это минимум для запуска.

для переноса в финалку ЧН, вместо 1) придётся перепаковать архивы, потом "aiwrapper -upgrade 3456" 

и дохера возни со скриптами, конфигурационными файлами и моделями.

для частичного переноса карт из ТЧ в ЧН, видимо, придётся все их декомпилировать, править ИИ-компоненты, 

склеивать новый game.graph и делать -upgrade. как сохранить smart_cover's -- х.з. перенос карт ЧН в 

ТЧ -- то же самое кроме двух последних действий.

дополнение 7.09.08:

И еще про полный перенос ТЧ в ЧН (3502, не 3120). all.spawn, который получится после

"aiwrapper -upgrade -3502", нужно будет один раз разобрать командой "acdc_cs.pl -d all.spawn -o aaa -w -l".
 
Потом -w не нужна, только -l. это как минимум, в действительности там ещё много чего придётся делать.

Вопрос:

После переноса ТЧ на двиг 3120 бессмертные NPC. Как исправить?

Ответ:

См. функцию invlulnerable(). вписать в xr_logic.script по аналогии. Как раз после этого нужно будет 

заменить .omf для людей во избежание вылета. Ну и гранаты в xml-профили npc добавьте.


Написал bardak, собрал loxotron.